                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ( Loader for figFORTH 1.1 )                                     1 WARNING !                                                     CR ." Loading screen editor " CR 20 LOAD 31 LOAD                CR ." Loading 8080 assembler " CR 40 LOAD                       CR ." Loading utilities " CR 60 LOAD 61 LOAD 62 LOAD            63 LOAD 64 LOAD                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ( Loader for figFORTH 1.3 )                                     1 WARNING !                                                     CR ." Loading editor extensions " CR 31 LOAD                    CR ." Loading 8080 assembler " CR 40 LOAD                       CR ." Loading utilities " CR 60 LOAD 61 LOAD 62 LOAD            63 LOAD 64 LOAD                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ( ERROR MESSAGES )                                              EMPTY STACK                                                     DICTIONARY FULL                                                 HAS INCORRECT ADDRESS MODE                                      ISN'T UNIQUE                                                                                                                    DISK RANGE?                                                     FULL STACK                                                      DISK ERROR!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ( ERROR MESSAGES )                                              COMPILATION ONLY, USE IN DEFINITION                             EXECUTION ONLY                                                  CONDITIONALS NOT PAIRED                                         DEFINITION NOT FINISHED                                         IN PROTECTED DICTIONARY                                         USE ONLY WHEN LOADING                                           OFF CURRENT EDITING SCREEN                                      DECLARE VOCABULARY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ( FORTH LINE EDITOR )                                           FORTH DEFINITIONS DECIMAL                                       VOCABULARY EDITOR IMMEDIATE                                     EDITOR DEFINITIONS                                                                                                              : TEXT  ( C -- )                                                  HERE C/L 1+ BLANKS WORD HERE PAD C/L 1+ CMOVE ;                                                                               : LINE  ( N -- ADR )                                              DUP 65520 AND 17 ?ERROR SCR @ (LINE) DROP ;                                                                                   : -MOVE  ( ADR N -- )                                             LINE C/L CMOVE UPDATE ;                                                                                                       -->                                                                                                                             ( FORTH LINE EDITOR )                                           : H  ( N -- )                                                     LINE PAD 1+ C/L DUP PAD C! CMOVE ;                                                                                            : E  ( N -- )                                                     LINE C/L BLANKS UPDATE ;                                                                                                      : S  ( N -- )                                                     DUP 1 - 14 DO FORTH I LINE I 1+ -MOVE                           -1 +LOOP E ;                                                                                                                  : D  ( N -- )                                                     DUP H 15 DUP ROT DO FORTH I 1+ LINE                             I -MOVE LOOP E ;                                                                                                              -->                                                             ( FORTH LINE EDITOR )                                           : R  ( N -- )                                                     PAD 1+ SWAP -MOVE ;                                                                                                           : I  ( N -- )                                                     DUP S R ;                                                                                                                     : P  ( N -- )                                                     1 TEXT R ;                                                                                                                    : L  ( N -- )                                                     SCR @ LIST ;                                                                                                                  : B  ( -- )                                                       SCR @ 1 - SCR ! ;                                             -->                                                             ( FORTH LINE EDITOR )                                           : N  ( -- )                                                       SCR @ 1+ SCR ! ;                                                                                                              : CLEAR  ( N -- )                                                 DUP SCR ! B/SCR * B/SCR 0 DO DUP BLOCK                          B/BUF BLANKS UPDATE 1+ LOOP DROP ;                                                                                            : COPY  ( N1 N2 -- )                                              FLUSH B/SCR * OFFSET @ + SWAP  B/SCR *                          B/SCR OVER + SWAP DO DUP FORTH I BLOCK                          2 - ! 1+ UPDATE LOOP DROP FLUSH ;                                                                                             FORTH DEFINITIONS                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               (  TEXT,  LINE                                    WFR-79MAY01 ) FORTH  DEFINITIONS   HEX                                        : TEXT                        ( ACCEPT FOLLOWING TEXT TO PAD *)      HERE  C/L  1+   BLANKS  WORD  HERE  PAD  C/L  1+  CMOVE  ;                                                                 : LINE              ( RELATIVE TO SCR, LEAVE ADDRESS OF LINE *)       DUP  FFF0  AND  17  ?ERROR   ( KEEP ON THIS SCREEN )            SCR  @  (LINE)  DROP  ;                                   -->                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             (  LINE EDITOR                                    WFR-79MAY03 ) VOCABULARY  EDITOR  IMMEDIATE    HEX                            : WHERE                  ( PRINT SCREEN # AND IMAGE OF ERROR *)     DUP  B/SCR  /  DUP  SCR  !  ." SCR # "  DECIMAL  .              SWAP  C/L  /MOD  C/L  *  ROT  BLOCK  +  CR  C/L  TYPE           CR  HERE  C@  -  SPACES  5E EMIT  [COMPILE] EDITOR  QUIT  ;                                                                 EDITOR  DEFINITIONS                                             : #LOCATE                    ( LEAVE CURSOR OFFSET-2, LINE-1 *)          R#  @  C/L  /MOD  ;                                    : #LEAD                 ( LINE ADDRESS-2, OFFSET-1 TO CURSOR *)          #LOCATE  LINE  SWAP  ;                                 : #LAG              ( CURSOR ADDRESS-2, COUNT-1 AFTER CURSOR *)          #LEAD  DUP  >R  +  C/L  R>  -  ;                       : -MOVE      ( MOVE IN BLOCK BUFFER ADDR FROM-2,  LINE TO-1 *)           LINE  C/L  CMOVE  UPDATE  ;  -->                       (  LINE EDITING COMMANDS                          WFR-79MAY03 ) : H                              ( HOLD NUMBERED LINE AT PAD *)       LINE  PAD  1+  C/L  DUP  PAD  C!  CMOVE  ;                                                                                : E                               ( ERASE LINE-1 WITH BLANKS *)       LINE  C/L  BLANKS  UPDATE  ;                                                                                              : S                             ( SPREAD MAKING LINE # BLANK *)       DUP  1  -  ( LIMIT )  0E ( FIRST TO MOVE )                      DO  I  LINE  I  1+  -MOVE  -1  +LOOP  E  ;                                                                                : D                         ( DELETE LINE-1, BUT HOLD IN PAD *)       DUP  H  0F  DUP  ROT                                            DO  I  1+  LINE  I  -MOVE  LOOP  E  ;                                                                                     -->                                                             (  LINE EDITING COMMANDS                          WFR-79MAY03 )                                                                 : M    ( MOVE CURSOR BY SIGNED AMOUNT-1, PRINT ITS LINE *)           R#  +!  CR  SPACE  #LEAD  TYPE  5F  EMIT                                           #LAG   TYPE  #LOCATE  .  DROP  ;                                                                        : T    ( TYPE LINE BY #-1,  SAVE ALSO IN PAD *)                      DUP  C/L  *  R#  !  DUP  H  0  M  ;                                                                                        : L     ( RE-LIST SCREEN *)                                             SCR  @  LIST  0  M  ;                                   -->                                                                                                                                                                                                                                                                                                                             (  LINE EDITING COMMANDS                           WFR-790105 ) : R                          ( REPLACE ON LINE #-1, FROM PAD *)       PAD  1+  SWAP  -MOVE  ;                                                                                                   : P                           ( PUT FOLLOWING TEXT ON LINE-1 *)       1  TEXT  R  ;                                                                                                             : I                       ( INSERT TEXT FROM PAD ONTO LINE # *)       DUP  S  R  ;                                                                                                              : TOP                    ( HOME CURSOR TO TOP LEFT OF SCREEN *)       0  R#  !  ;                                               -->                                                                                                                                                                                                                                                             (  SCREEN EDITING COMMANDS                        WFR-79APR27 ) : CLEAR                           ( CLEAR SCREEN BY NUMBER-1 *)       SCR  !  10  0  DO  FORTH  I  EDITOR  E  LOOP  ;                                                                           : FLUSH                   ( WRITE ALL UPDATED BLOCKS TO DISC *)     [  LIMIT  FIRST  -  B/BUF  4  +  /  ]  ( NUMBER OF BUFFERS)     LITERAL  0  DO  7FFF  BUFFER  DROP  LOOP  ;                                                                                 : COPY                   ( DUPLICATE SCREEN-2, ONTO SCREEN-1 *)    B/SCR  *  OFFSET  @  +  SWAP  B/SCR  *  B/SCR  OVER  +  SWAP    DO  DUP  FORTH  I  BLOCK  2  -  !  1+   UPDATE  LOOP            DROP  FLUSH  ;                                               -->                                                                                                                                                                                                                                                             (  DOUBLE NUMBER SUPPORT                          WFR-80APR24 ) (  OPERATES ON 32 BIT DOUBLE NUMBERS   OR TWO 16-BIT INTEGERS ) FORTH DEFINITIONS                                                                                                               : 2DROP   DROP    DROP  ;  ( DROP DOUBLE NUMBER )                                                                               : 2DUP    OVER    OVER  ;  ( DUPLICATE A DOUBLE NUMBER )                                                                        : 2SWAP   ROT     >R    ROT   R>  ;                                     ( BRING SECOND DOUBLE TO TOP OF STACK )                 EDITOR DEFINITIONS  -->                                                                                                                                                                                                                                                                                                                                                                         (  STRING MATCH FOR EDITOR                     PM-WFR-80APR25 ) : -TEXT                   ( ADDRESS-3, COUNT-2, ADDRESS-1 --- )  SWAP   -DUP  IF  ( LEAVE BOOLEAN MATCHED-NON-ZERO, NOPE-ZERO )              OVER + SWAP       ( NEITHER ADDRESS MAY BE ZERO! )         DO  DUP  C@  FORTH  I  C@  -                                        IF  0=  LEAVE  ELSE  1+  THEN    LOOP                       ELSE  DROP  0=  THEN ;                                  : MATCH   ( CURSOR ADDRESS-4, BYTES LEFT-3, STRING ADDRESS-2, )           ( STRING COUNT-1, ---  BOOLEAN-2, CURSOR MOVEMENT-1 )   >R  >R  2DUP  R>  R>  2SWAP  OVER  +  SWAP                      ( CADDR-6, BLEFT-5, $ADDR-4, $LEN-3, CADDR+BLEFT-2, CADDR-1 )   DO  2DUP  FORTH   I   -TEXT                                       IF  >R  2DROP  R>  -  I  SWAP  -  0  SWAP  0  0  LEAVE              (  CADDR BLEFT  $ADDR  $LEN  OR ELSE 0  OFFSET  0  0  )       THEN  LOOP 2DROP   ( CADDR-2, BLEFT-1, OR 0-2, OFFSET-1 )     SWAP  0=  SWAP  ;    -->                                    (  STRING EDITING COMMANDS                        WFR-79MAR24 ) : 1LINE       ( SCAN LINE WITH CURSOR FOR MATCH TO PAD TEXT, *)                              ( UPDATE CURSOR, RETURN BOOLEAN *)        #LAG  PAD  COUNT  MATCH  R#   +!   ;                                                                                     :  FIND   ( STRING AT PAD OVER FULL SCREEN RANGE, ELSE ERROR *)      BEGIN  3FF  R#  @  <                                                IF  TOP  PAD  HERE  C/L  1+  CMOVE  0  ERROR  ENDIF             1LINE   UNTIL   ;                                                                                                      : DELETE                    ( BACKWARDS AT CURSOR BY COUNT-1 *)     >R  #LAG  +  FORTH  R  -  ( SAVE BLANK FILL LOCATION )          #LAG  R MINUS  R#  +!     ( BACKUP CURSOR )                     #LEAD  +  SWAP  CMOVE                                           R>  BLANKS  UPDATE  ;   ( FILL FROM END OF TEXT )           -->                                                             (  STRING EDITOR COMMANDS                         WFR-79MAR24 ) : N     ( FIND NEXT OCCURANCE OF PREVIOUS TEXT *)                     FIND  0  M  ;                                                                                                             : F      ( FIND OCCURANCE OF FOLLOWING TEXT *)                        1  TEXT  N  ;                                                                                                             : B      ( BACKUP CURSOR BY TEXT IN PAD *)                            PAD  C@  MINUS  M  ;                                                                                                      : X     ( DELETE FOLLOWING TEXT *)                                    1  TEXT  FIND  PAD  C@  DELETE  0  M  ;                                                                                   : TILL      ( DELETE ON CURSOR LINE, FROM CURSOR TO TEXT END *)       #LEAD  +  1  TEXT  1LINE  0=  0  ?ERROR                         #LEAD  +  SWAP  -  DELETE  0  M  ;     -->                (  STRING EDITOR COMMANDS                         WFR-79MAR23 ) : C        ( SPREAD AT CURSOR AND COPY IN THE FOLLOWING TEXT *)     1  TEXT  PAD  COUNT                                             #LAG  ROT  OVER  MIN  >R                                        FORTH  R  R#  +!  ( BUMP CURSOR )                               R  -  >R          ( CHARS TO SAVE )                             DUP  HERE  R  CMOVE  ( FROM OLD CURSOR TO HERE )                HERE  #LEAD  +  R>  CMOVE  ( HERE TO CURSOR LOCATION )          R>  CMOVE  UPDATE   ( PAD TO OLD CURSOR )                       0  M  ( LOOK AT NEW LINE )  ;                               FORTH  DEFINITIONS   DECIMAL                                    LATEST   12  +ORIGIN  !   ( TOP NFA )                           HERE     28  +ORIGIN  !   ( FENCE )                             HERE     30  +ORIGIN  !   ( DP )                                '  EDITOR  6  +   32  +ORIGIN  !  ( VOC-LINK )                  HERE  FENCE   !      ;S                                         ( EDITOR EXTENSION: NEW UNDER                     KHR 9FEB81 )  EDITOR DEFINITIONS                                              : ENTER? ( start-line# current-line# - f ) OVER = ;             : ENTER ( - ) QUERY 1 TEXT ;                                    : NULL? ( - f ) TIB @ C@ 0= ;                                   : .BS ( - ) 8 EMIT ;                                                                                                            : NEW ( start-line# - ) FORTH 16 0 DO CR I 3 .R SPACE             I ENTER? IF ENTER NULL? IF .BS I SCR @ .LINE ELSE               I EDITOR R FORTH 1+ THEN ELSE I SCR @ .LINE                     THEN LOOP DROP ;                                              : UNDER ( start-line# - ) FORTH 1+ 16 0 DO CR I 3 .R SPACE        I ENTER? IF ENTER NULL? IF .BS I SCR @ .LINE ELSE               I EDITOR I FORTH 1+ THEN ELSE I SCR @ .LINE                     THEN LOOP DROP ;                                              FORTH DEFINITIONS                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ( 8080 ASSEMBLER )                                              HEX                                                             VOCABULARY ASSEMBLER IMMEDIATE                                                                                                  : CODE   ?EXEC CREATE [COMPILE] ASSEMBLER !CSP ;  IMMEDIATE     : ;CODE  ?CSP COMPILE (;CODE) [COMPILE] [                                [COMPILE] ASSEMBLER !CSP ;               IMMEDIATE     : LABEL  ?EXEC 0 VARIABLE SMUDGE -2 ALLOT                                [COMPILE] ASSEMBLER !CSP ;               IMMEDIATE                                                                     ASSEMBLER DEFINITIONS                                                                                                           : END-CODE CURRENT @ CONTEXT ! ?EXEC ?CSP SMUDGE ; IMMEDIATE                                                                    -->                                                                                                                             ( 8080 ASSEMBLER )                                              4 CONSTANT H   5 CONSTANT L   7 CONSTANT A   6 CONSTANT PSW     2 CONSTANT D   3 CONSTANT E   0 CONSTANT B   1 CONSTANT C       6 CONSTANT M   6 CONSTANT SP                                                                                                                                                                    : INH <BUILDS C, DOES> C@ C, ;                                  07 INH RLC,   0F INH RRC,   17 INH RAL,   1F INH RAR,           27 INH DAA,   2F INH CMA,   37 INH STC,   3F INH CMC,           00 INH NOP,                                                     E3 INH XTHL,  E9 INH PCHL,  EB INH XCHG,  F3 INH DI,            F9 INH SPHL,  FB INH EI,                                        C0 INH RNZ,   C8 INH RZ,    C9 INH RET,   D0 INH RNC,           D8 INH RC,    E0 INH RPO,   E8 INH RPE,   F0 INH RP,            F8 INH RM,                                                      -->                                                             ( 8080 ASSEMBLER )                                              : SSS <BUILDS C, DOES> C@ + C, ;                                : DDD <BUILDS C, DOES> C@ SWAP 8 * + C, ;                                                                                       80 SSS ADD,   88 SSS ADC,   90 SSS SUB,   98 SSS SBB,           A0 SSS ANA,   A8 SSS XRA,   B0 SSS ORA,   B8 SSS CMP,           02 DDD STAX,  03 DDD INX,   04 DDD INR,   05 DDD DCR,           09 DDD DAD,   0A DDD LADX,  0B DDD DCX,                         C1 DDD POP,   C5 DDD PUSH,  C7 DDD RST,                                                                                         : ABYT <BUILDS C, DOES> C@ C, C, ;                              C6 ABYT ADI,   CE ABYT ACI,   D3 ABYT OUT,                      D6 ABYT SUI,   DB ABYT IN,    DE ABYT SBI,                      E6 ABYT ANI,   FE ABYT CPI,   EE ABYT XRI,   F6 ABYT ORI,                                                                       -->                                                             ( 8080 ASSEMBLER )                                              : AWORD <BUILDS C, DOES> C@ C, , ;                              22 AWORD SHLD,  2A AWORD LHLD,  32 AWORD STA,   3A AWORD LDA,   C3 AWORD JMP,   C4 AWORD CNZ,   CC AWORD CZ,    CD AWORD CALL,  D4 AWORD CNC,   DC AWORD CC,    E4 AWORD CPO,   EC AWORD CPE,   F4 AWORD CP,    FC AWORD CM,                                                                                                    147 CONSTANT NEXT  146 CONSTANT HPUSH  145 CONSTANT DHPUSH                                                                      : MOV, 8 * 40 + + C, ;   : MVI, 8 * 6 + C, C, ;                 : LXI, 8 * 1+ C, , ;                                                                                                            -->                                                                                                                                                                                                                                                             ( 8080 ASSEMBLER )                                              C2 CONSTANT 0=    D2 CONSTANT CS    E2 CONSTANT PE              F2 CONSTANT 0<    : NOT 8 + ;                                                                                                   DA AWORD JC,    D2 AWORD JNC,   CA AWORD JZ,    C2 AWORD JNZ,   FA AWORD JM,    F2 AWORD JP,    EA AWORD JPE,   E2 AWORD JPO,                                                                   : IF, C, HERE 0 , 2 ;                                                                                                           : ENDIF, ?EXEC 2 ?PAIRS HERE SWAP ! ;                                                                                           : ELSE, 2 ?PAIRS C3 IF, ROT HERE SWAP ! ;                                                                                       -->                                                                                                                                                                                             ( 8080 ASSEMBLER )                                              : BEGIN, HERE 1 ;                                                                                                               : AGAIN, ?EXEC 1 ?PAIRS JMP, ;                                                                                                  : UNTIL, SWAP ?EXEC 1 ?PAIRS C, , ;                                                                                             : WHILE, SWAP 1 ?PAIRS IF, 4 ;                                                                                                  : REPEAT, ?EXEC 4 ?PAIRS ROT C3 C, , ENDIF, ;                   FORTH DEFINITIONS DECIMAL                                       LATEST   12 +ORIGIN !  ( TOP NFA )                              HERE     28 +ORIGIN !  ( FENCE )                                HERE     30 +ORIGIN !  ( DP )                                   ' ASSEMBLER 9 + 32 +ORIGIN !  ( VOC-LINK )                      HERE FENCE !         ;S                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ( ASSEMBLER EXAMPLE )                                           HEX                                                             CODE TEST                                                         0 A MVI,                                                        C000 H LXI,                                                     0 D LXI,                                                      BEGIN,                                                            A M MOV,                                                        H INX,  A INR,                                                0= UNTIL,                                                         NEXT JMP,                                                     END-CODE                                                        DECIMAL                                                                                                                                                                                                                                                         ( ASSEMBLER EXAMPLE )                                           CODE (RET;)                                                       ' ;S 1+ @ DUP LHLD, M C MOV, H INX, M B MOV,                    H INX, SHLD, RET,                                             END-CODE                                                                                                                        : RET; ?CSP COMPILE (RET;) SMUDGE [COMPILE] [ ; IMMEDIATE                                                                       : S1 ." The quick brown fox... " ;  : CALL.S1 S1 RET;           : S2 ." jumps over the lazy dog " ; : CALL.S2 S2 RET;                                                                           CODE PRINT                                                        ' CALL.S1 CFA H LXI, NEXT 6 + CALL,                             ' CALL.S2 CFA H LXI, NEXT 6 + CALL,                             NEXT JMP,                                                     END-CODE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ( UTILITIES - DUMP )                                            HEX                                                             : DUMP                                                            CR CR BASE @ HEX ROT ROT 1+ SWAP                                DO                                                                I 0 8 D.R                                                       3A EMIT SPACE                                                   I                                                               10 0 DO                                                           DUP I + C@ DUP 10 <                                             IF SPACE 30 EMIT 1 .R ELSE 3 .R ENDIF                         LOOP                                                            DROP CR                                                       10 +LOOP                                                        BASE !                                                        ; DECIMAL                                                       ( UTILITIES - .S )                                              : PST CR ." === STACK === " CR ;                                                                                                : PNR SP@ - 2 / 4 .R ;                                                                                                          : EMPTY? SP@ S0 @ = IF ." EMPTY "                                 R> DROP ENDIF ;                                                                                                               : .S PST EMPTY?                                                   SP@ 2 - S0 @ 2 -                                                DO I PNR                                                          I @ 6 .R CR                                                   -2 +LOOP ;                                                                                                                                                                                                                                                    ( UTILITIES - J )                                               ( FORTH-79 )                                                                                                                    : J RP@ 6 + @ ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ( UTILITIES - PICK )                                            ( FORTH-79 )                                                                                                                    : PICK SP@ SWAP 2 * + @ ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ( UTILITIES - BDOS )                                            CODE BDOS0              ( Call BDOS, no return value )              H POP, D POP,       ( function and argument )                   B PUSH,                                                         L C MOV,            ( function -> C )                           5 CALL,             ( call BDOS )                               B POP,                                                          NEXT JMP,                                                   END-CODE                                                                                                                        ( EMIT CHARACTERS TO LINE PRINTER VIA BDOS )                    : PEMIT 5 BDOS0 ;                                               : PCR 13 PEMIT 10 PEMIT ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ( TERMINAL - VT100 )                                            FORTH DEFINITIONS DECIMAL                                       : GOTOXY ( X Y ) 27 EMIT 91 EMIT 0 MAX 23 MIN 1+ S->D             <# # # #> TYPE 59 EMIT 0 MAX 79 MIN 1+ S->D <# # # #> TYPE      72 EMIT ;                                                     : CLEARSCREEN 27 EMIT 91 EMIT 50 EMIT 74 EMIT ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ( TERMINAL - IMSAI VIO )                                        FORTH DEFINITIONS DECIMAL                                       : GOTOXY ( X Y ) 27 EMIT 61 EMIT                                  0 MAX 23 MIN 32 + EMIT 0 MAX 79 MIN 32 + EMIT ;               : CLEARSCREEN 26 EMIT ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ( TOWERS OF HANOI     Copyright, 1979, Peter Midnight )         FORTH DEFINITIONS DECIMAL   : TASK ;                            ( First extend Forth to include a few features of Pascal )      : MYSELF ( In definition, this is a recursive use of new )        LATEST PFA CFA , ; IMMEDIATE                    ( word )      : 4DUP 4 PICK 4 PICK 4 PICK 4 PICK ;                            12 CONSTANT NMAX ( maximum permisable number of rings )         NMAX VARIABLE (N) : N (N) @ ; ( formerly a constant )           0 CONSTANT HELL_FREEZES_OVER   43 CONSTANT COLOR ( + )          0 VARIABLE RING  N 2 - ALLOT  ( array [1..N] of bytes )                                                                                                                                                                                                                                                                         -->                                                                                                                             ( TOWERS OF HANOI     Copyright, 1979, Peter Midnight )         : DELAY         ( centiseconds )                                  0 DO  17 0 DO  127 127 * DROP LOOP LOOP ;                     : POS           ( location -> coordinate )                        2 N * 1+ * N + ;                                              : HALFDISPLAY   ( color size )                                    0 DO DUP EMIT LOOP DROP ;                                     : <DISPLAY>     ( line color size )                               2DUP HALFDISPLAY ROT 3 < IF BL ELSE 124 ( | )                   THEN EMIT HALFDISPLAY ;                                       : DISPLAY       ( size pos line color )                           SWAP >R ROT ROT OVER - R ( color size pos-size line )           GOTOXY R> ( color size line ) ROT ROT <DISPLAY> ;                                                                             -->                                                                                                                             ( TOWERS OF HANOI     Copyright, 1979, Peter Midnight )         : PRESENCE    ( tower ring -> boolean )                           RING + C@ = ;                                                 : LINE        ( tower -> display_line_of_top )                    4 SWAP N 0 DO DUP I PRESENCE 0= ROT + SWAP LOOP DROP ;        : 1- 1 - ;                                                                                                                      : RAISE       ( size tower )                                      DUP POS SWAP LINE 1 SWAP DO                                     2DUP I BL DISPLAY 2DUP I 1- COLOR DISPLAY                       -1 +LOOP 2DROP ;                                              : LOWER      ( size tower )                                       DUP POS SWAP LINE 1+ 2 DO                                       2DUP I 1- BL DISPLAY 2DUP I COLOR DISPLAY                       LOOP 2DROP ;                                                  -->                                                             ( TOWERS OF HANOI     Copyright, 1979, Peter Midnight )         : MOVELEFT  ( size source_tower destination_tower )               POS 1- SWAP POS 1- DO DUP R 1+ 1 BL DISPLAY                     DUP R 1 COLOR DISPLAY -1 +LOOP DROP ;                         : MOVERIGHT ( size source_tower destination_tower )               POS 1+ SWAP POS 1+ DO DUP R 1- 1 BL DISPLAY                     DUP R 1 COLOR DISPLAY LOOP DROP ;                             : TRAVERSE  ( size source_tower destination_tower )               2DUP > IF MOVELEFT ELSE MOVERIGHT THEN ;                      : MOVE      ( size source_tower destination_tower )               ?TERMINAL IF 0 N 4 + GOTOXY ABORT THEN                          ROT ROT 2DUP RAISE >R 2DUP R> ROT TRAVERSE                      2DUP RING + 1- C! SWAP LOWER ;                                                                                                -->                                                                                                                             ( TOWERS OF HANOI     Copyright, 1979, Peter Midnight )         : MULTIMOV  ( size source destination spare )                     4 PICK 1 = IF DROP MOVE ELSE                                    >R >R SWAP 1- SWAP R> R> 4DUP SWAP MYSELF                       4DUP DROP ROT 1+ ROT ROT MOVE                                   ROT ROT SWAP MYSELF THEN ;                                                                                                    : MAKETOWER ( tower )                                             POS 4 N + 3 DO DUP I GOTOXY 124 EMIT ( | ) LOOP DROP ;        : MAKEBASE                                                        0 N 4 + GOTOXY N 6 * 3 + 0 DO 45 EMIT ( - ) LOOP ;            : MAKERING ( tower size )                                         2DUP RING + 1- C! SWAP LOWER ;                                : SETUP CLEARSCREEN                                               N 1+ 0 DO 1 RING I + C! LOOP 3 0 DO I MAKETOWER LOOP            MAKEBASE 0 N DO 0 I MAKERING -1 +LOOP ;   -->                 ( TOWERS OF HANOI     Copyright, 1979, Peter Midnight )         : TOWERS    ( quantity )                                          1 MAX NMAX MIN (N) !                                            SETUP N 2 0 1 BEGIN                                             OVER POS N 4 + GOTOXY N 0 DO 7 EMIT 50 DELAY LOOP               ROT 4DUP MULTIMOV                                               HELL_FREEZES_OVER UNTIL ;                                                                                                     ;S                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              